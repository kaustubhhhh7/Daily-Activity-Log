name: Daily Learning Automation

on:
  schedule:
    - cron: "30 4 * * *"   # 10:00 AM IST
  workflow_dispatch:

permissions:
  contents: write

jobs:
  learning-bot:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v4

      - name: Configure Git
        run: |
          git config --global user.name "github-actions[bot]"
          git config --global user.email "github-actions[bot]@users.noreply.github.com"

      # BACKEND (3 commits)
      - name: Backend - REST
        run: |
          DATE=$(date '+%Y-%m-%d')
          echo -e "\n## $DATE\n- REST APIs follow stateless client-server architecture." >> learning/backend.md
          git add learning/backend.md
          git commit -m "Backend: REST basics - $DATE" || echo "No change"

      - name: Backend - Auth
        run: |
          DATE=$(date '+%Y-%m-%d')
          echo -e "\n- JWT tokens are commonly used for stateless authentication." >> learning/backend.md
          git add learning/backend.md
          git commit -m "Backend: Authentication - $DATE" || echo "No change"

      - name: Backend - Error handling
        run: |
          DATE=$(date '+%Y-%m-%d')
          echo -e "\n- Proper HTTP status codes improve API clarity." >> learning/backend.md
          git add learning/backend.md
          git commit -m "Backend: Error handling - $DATE" || echo "No change"

      # AUTOMATION (3 commits)
      - name: Automation - Basics
        run: |
          DATE=$(date '+%Y-%m-%d')
          echo -e "\n## $DATE\n- Automation removes repetitive manual tasks." >> learning/automation.md
          git add learning/automation.md
          git commit -m "Automation: Basics - $DATE" || echo "No change"

      - name: Automation - Scripts
        run: |
          DATE=$(date '+%Y-%m-%d')
          echo -e "\n- Shell and Python scripts are widely used in automation." >> learning/automation.md
          git add learning/automation.md
          git commit -m "Automation: Scripts - $DATE" || echo "No change"

      - name: Automation - Scheduling
        run: |
          DATE=$(date '+%Y-%m-%d')
          echo -e "\n- Cron jobs help schedule automated tasks." >> learning/automation.md
          git add learning/automation.md
          git commit -m "Automation: Scheduling - $DATE" || echo "No change"

      # DEVOPS (2 commits)
      - name: DevOps - CI
        run: |
          DATE=$(date '+%Y-%m-%d')
          echo -e "\n## $DATE\n- Continuous Integration detects bugs early." >> learning/devops.md
          git add learning/devops.md
          git commit -m "DevOps: CI - $DATE" || echo "No change"

      - name: DevOps - CD
        run: |
          DATE=$(date '+%Y-%m-%d')
          echo -e "\n- Continuous Deployment automates releases." >> learning/devops.md
          git add learning/devops.md
          git commit -m "DevOps: CD - $DATE" || echo "No change"

      # SECURITY (2 commits)
      - name: Security - AuthN
        run: |
          DATE=$(date '+%Y-%m-%d')
          echo -e "\n## $DATE\n- Authentication verifies user identity." >> learning/security.md
          git add learning/security.md
          git commit -m "Security: Authentication - $DATE" || echo "No change"

      - name: Security - AuthZ
        run: |
          DATE=$(date '+%Y-%m-%d')
          echo -e "\n- Authorization defines access levels." >> learning/security.md
          git add learning/security.md
          git commit -m "Security: Authorization - $DATE" || echo "No change"

      # SUMMARY (2 commits)
      - name: Summary - Learning
        run: |
          DATE=$(date '+%Y-%m-%d')
          echo -e "\n## $DATE\n- Studied backend, automation, DevOps, and security." >> learning/summary.md
          git add learning/summary.md
          git commit -m "Summary: Learning log - $DATE" || echo "No change"

      - name: Summary - Reflection
        run: |
          DATE=$(date '+%Y-%m-%d')
          echo -e "\n- Consistency beats intensity in learning." >> learning/summary.md
          git add learning/summary.md
          git commit -m "Summary: Reflection - $DATE" || echo "No change"

      - name: Push all commits
        run: git push
